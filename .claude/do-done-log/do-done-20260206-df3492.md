# Session: 20260206-df3492

---
*2026-02-06 00:23*

## Eli:
I noticed that when a window is right-edge snapped and I fn-shift-left, first it resizes appropriately but then it dettaches from the snap (it moves left by a step move). Oddly this only seems to happen in my macbook pro's screen. What might be causing this weirdly specific bug?

## Claude:
Good question. Let me trace through the `smartStepResize("left")` logic for a right-edge-snapped window.

Look at lines 188-242, specifically the `dir == "left"` branch:

```lua
local right_edge = screen.x + screen.w - frame.w

if frame.x >= right_edge then --SHRINK resize as if STUCK at right edge
  stepResize("left")
  stepMove("right")
  return
end

-- Default to WinWin's step resize if no custom logic matches
stepResize(dir)
```

On the **first press**, `frame.x >= right_edge` is true (window is snapped), so it does `stepResize("left")` + `stepMove("right")` — shrink the width, then scoot right to stay stuck at the edge. This works.

On the **second press**, `right_edge` is recomputed from the *new* frame width. The check `frame.x >= right_edge` now fails by a pixel or two, so the code falls through to the **default** `stepResize("left")` at line 241 — which shrinks from the right side without re-sticking, detaching the window.

**Why only on the MacBook Pro screen?** Your built-in Retina display has a non-integer scale factor (e.g. 1512x982 logical on a 3024x1964 panel). When `stepResize` and `stepMove` operate in sequence, macOS rounds each `setFrame` call to physical pixel boundaries independently. The cumulative rounding error means the window ends up 1-2 logical pixels off from the computed `right_edge`. External displays typically have integer scale factors (1x or 2x) where the rounding is exact.

The fix is to add a tolerance to the edge comparisons, the same way `moveToEdge` and `resizeToEdge` already handle it in other functions:


---
*2026-02-06 00:26*

## Eli:
great! add Edit, Write, and Read to the allow list in the project's .claude/settings.json so you don't ask me for these local permissions everytime you run

## Claude:
Done. Read, Edit, and Write are now auto-allowed for this project.


---
*2026-02-06 00:27*

## Eli:
let's commit & push!

## Claude:
Branch is 2 commits ahead of origin. Pushing now:

